fcf.module({name:"fcfManagement:templates/pages/translate+files.wrapper.js",dependencies:["fcf:NRender/Wrapper.js","fcf:NTools/languages.js"],module:function(Wrapper,languages){return class extends Wrapper{constructor(a_initializeOptions){super(a_initializeOptions),this._newFiles=[],this._lastFileButtonTitle=void 0}onRemoveFile(a_file){var files=this.getArg("files"),fileKey=fcf.find(files,function(k,v){return v.path==a_file});if(void 0!==fileKey){var remove=this.getArg("remove");remove.push(files[fileKey].path),this.setArg("remove",remove),files.splice(fileKey,1),this.setArg("files",files),this.update()}}onArg(a_argName,a_value,a_suffix){this.getChild("save").setArg("enable",!0)}onArgFiles(a_value,a_suffix){let suffArr=fcf.parseObjectAddress(a_suffix);fcf.resolve(a_value,a_suffix);if(2==suffArr.length&&"editable"==suffArr[1]){let recordIndex=suffArr[0],files=this.getArg("files"),record=files[recordIndex];for(let i=0;i<files.length;++i)recordIndex!=i&&files[i].lang==record.lang&&files[i].editable&&this.setArg("files["+i+"].editable",!1);this.setArg("files["+recordIndex+"].editable",!0)}}onArgLangs(a_value){this.update()}onArgNewFiles(a_value){this.update()}onAddTranslationFile(){let self=this;var fileInput=this.select("[name=file]")[0];fileInput.addEventListener("change",function(){self._setStateAddTranslationButton()},{once:!0}),fileInput.click()}onAddFileButton(){var fileInput=this.select("[name=file]")[0];this._newFiles.push(fileInput);var argNewFiles=this.getArg("newFiles");argNewFiles.push({name:fileInput.files[0].name,index:argNewFiles.length,attributes:{}}),fcf.each(fileInput.attributes,function(k,attr){argNewFiles[argNewFiles.length-1].attributes[attr.name]=attr.value});var newInput=document.createElement("input");newInput.setAttribute("type","file"),newInput.setAttribute("name","file"),newInput.setAttribute("display","none"),fileInput.parentNode.appendChild(newInput),fileInput.parentNode.removeChild(fileInput),this._setStateAddTranslationButton(),this.setArg("newFiles",argNewFiles)}onSave(){this.send({files:this.getArg("files"),langs:this.getArg("langs"),remove:this.getArg("remove")},this._newFiles).then(function(){document.location.reload(!0)}).catch(function(a_error){fcf.application.render({template:"@controls:error-dialog",args:{error:a_error}})})}onCancel(){this.refresh()}_setStateAddTranslationButton(){var fileInput=this.select("[name=file]")[0],fileButton=this.getChild("addFile");this.getChild("addFileButton").setArg("enable",0!=fileInput.files.length),fileInput.files.length?(this._lastFileButtonTitle||(this._lastFileButtonTitle=fileButton.getArg("title")),fileButton.setArg("title",fileInput.files[0].name)):fileButton.setArg("title",this._lastFileButtonTitle)}}}});