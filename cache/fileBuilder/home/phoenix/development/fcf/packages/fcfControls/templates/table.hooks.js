fcf.module({name:"fcfControls:templates/table.hooks.js",dependencies:["fcf:NTools/view.js"],module:function(toolsView){fcf.prepareObject(fcf,"NFSQL.NFilter");return{hooksProgramableArgument:{_links:function(a_taskInfo){var links=[],filter=a_taskInfo.args.filter,patternArgs=void 0,patternLinkArgs=void 0;return fcf.each(a_taskInfo.args.value,function(indexRow,row){filter&&(patternArgs={record:row,index:indexRow,row:indexRow},patternLinkArgs={id:a_taskInfo.args.fcfId,references:{record:'value["'+indexRow+'"]',args:""}},!fcf.pattern(filter,patternArgs,patternLinkArgs))||(links.push({row:indexRow,index:indexRow,columns:[]}),fcf.each(a_taskInfo.args.columns,function(a_indexColumn,a_column){links[links.length-1].columns.push({row:indexRow,index:indexRow,column:a_indexColumn})}))}),fcf.actions().exec(function(a_act){fcf.empty(a_taskInfo.args.search)?a_act.complete():toolsView.getFilters(a_taskInfo.args.columns).then(function(a_filters){for(var newLinks=[],search=a_taskInfo.args.search.toLowerCase(),linkIndex=0;linkIndex<links.length;++linkIndex){for(var found=!1,record=a_taskInfo.args.value[links[linkIndex].row],lnkColumns=links[linkIndex].columns,indexColumn=0;indexColumn<lnkColumns.length;++indexColumn){var view=a_taskInfo.args.columns[lnkColumns[indexColumn].column],value=record[view.alias];if(void 0!=value)if(-1!=a_filters[view.alias].friendly(view,value).toLowerCase().indexOf(search)){found=!0;break}}found&&newLinks.push(links[linkIndex])}links=newLinks,a_act.complete()}).catch(function(a_error){a_act.error(a_error)})}).then(function(){var length=links.length,page=fcf.range(a_taskInfo.args.page,1,Math.floor(length/a_taskInfo.args.outputRowCount)+(length%a_taskInfo.args.outputRowCount!=0?1:0));a_taskInfo.setArg("_page",page);var beginRecord=fcf.range(a_taskInfo.args.outputRowCount*(page-1),0,fcf.max(0,length-1)),endRecord=fcf.range(beginRecord+a_taskInfo.args.outputRowCount,0,fcf.max(0,length)),pageCount=length%a_taskInfo.args.outputRowCount?Math.floor(length/a_taskInfo.args.outputRowCount)+1:Math.floor(length/a_taskInfo.args.outputRowCount);return a_taskInfo.setArg("_pageCount",pageCount),links.slice(beginRecord,endRecord)})}}}}});